{"created": 1757431769.695806, "duration": 0.641049861907959, "exitcode": 1, "root": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests", "environment": {}, "summary": {"failed": 11, "passed": 3, "total": 14, "collected": 14}, "collectors": [{"nodeid": "", "outcome": "passed", "result": [{"nodeid": "test_orchestrator_isolation.py", "type": "Module"}]}, {"nodeid": "test_orchestrator_isolation.py::TestClient", "outcome": "passed", "result": []}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation", "outcome": "passed", "result": [{"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_health_endpoint", "type": "Function", "lineno": 34}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_config_endpoint", "type": "Function", "lineno": 42}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_metrics_endpoint", "type": "Function", "lineno": 51}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_chat_sync_without_rag", "type": "Function", "lineno": 58}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_chat_stream_with_rag", "type": "Function", "lineno": 95}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_chat_without_auth_fails", "type": "Function", "lineno": 131}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_health_endpoints_no_auth_required", "type": "Function", "lineno": 138}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_retrieve_proxy_endpoint", "type": "Function", "lineno": 150}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_ingest_proxy_endpoint", "type": "Function", "lineno": 171}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_tts_proxy_endpoint", "type": "Function", "lineno": 190}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_invalid_endpoint_returns_404", "type": "Function", "lineno": 214}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_cors_headers_present", "type": "Function", "lineno": 219}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_error_handling_upstream_failure", "type": "Function", "lineno": 225}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_request_correlation_id", "type": "Function", "lineno": 246}]}, {"nodeid": "test_orchestrator_isolation.py", "outcome": "passed", "result": [{"nodeid": "test_orchestrator_isolation.py::TestClient", "type": "Class"}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation", "type": "Class"}]}], "tests": [{"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_health_endpoint", "lineno": 34, "outcome": "failed", "keywords": ["test_health_endpoint", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.02349237515591085, "outcome": "passed"}, "call": {"duration": 0.006004625000059605, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 41, "message": "AssertionError: assert 'service' in {'status': 'ok'}"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 41, "message": "in test_health_endpoint"}], "stdout": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/health\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"276126c6-25f3-4e20-b8d6-9a547c8d4ca8\", \"sid\": \"32ee602b-ae1f-4ca3-aea4-1dc103c5a2d7\"}\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/health\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"276126c6-25f3-4e20-b8d6-9a547c8d4ca8\", \"sid\": \"32ee602b-ae1f-4ca3-aea4-1dc103c5a2d7\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.174865, "msecs": 174.0, "relativeCreated": 810.4310035705566, "thread": 6139588608, "threadName": "ThreadPoolExecutor-0_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:41: in test_health_endpoint\n    assert \"service\" in data\nE   AssertionError: assert 'service' in {'status': 'ok'}"}, "teardown": {"duration": 0.0002940420527011156, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_config_endpoint", "lineno": 42, "outcome": "failed", "keywords": ["test_config_endpoint", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.002776749897748232, "outcome": "passed"}, "call": {"duration": 0.0022603750694543123, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 48, "message": "AssertionError: assert 'RAG_URL' in {'downstreams': {'analytics': 'http://analytics:8090', 'llm': 'http://llm:8012', 'rag': 'http://rag:8011', 'stt': 'ws://stt:8010', ...}, 'port': 8000, 'service': 'orchestrator'}"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 48, "message": "in test_config_endpoint"}], "stdout": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/config\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"871e76e3-7405-44fe-95e3-9f098a5de1bf\", \"sid\": \"d7f695df-67b3-46b1-ae7c-3e97229fb01f\"}\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/config\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"871e76e3-7405-44fe-95e3-9f098a5de1bf\", \"sid\": \"d7f695df-67b3-46b1-ae7c-3e97229fb01f\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.2011142, "msecs": 201.0, "relativeCreated": 836.6801738739014, "thread": 6139588608, "threadName": "ThreadPoolExecutor-1_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:48: in test_config_endpoint\n    assert \"RAG_URL\" in data\nE   AssertionError: assert 'RAG_URL' in {'downstreams': {'analytics': 'http://analytics:8090', 'llm': 'http://llm:8012', 'rag': 'http://rag:8011', 'stt': 'ws://stt:8010', ...}, 'port': 8000, 'service': 'orchestrator'}"}, "teardown": {"duration": 0.00023087509907782078, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_metrics_endpoint", "lineno": 51, "outcome": "failed", "keywords": ["test_metrics_endpoint", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.002652666997164488, "outcome": "passed"}, "call": {"duration": 0.0018630421254783869, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 57, "message": "assert 'ai_' in '# HELP python_gc_objects_collected_total Objects collected during gc\\n# TYPE python_gc_objects_collected_total counter\\npython_gc_objects_collected_total{generation=\"0\"} 6349.0\\npython_gc_objects_collected_total{generation=\"1\"} 4097.0\\npython_gc_objects_collected_total{generation=\"2\"} 2038.0\\n# HELP python_gc_objects_uncollectable_total Uncollectable objects found during GC\\n# TYPE python_gc_objects_uncollectable_total counter\\npython_gc_objects_uncollectable_total{generation=\"0\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"1\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"2\"} 0.0\\n# HELP python_gc_collections_total Number of times this generation was collected\\n# TYPE python_gc_collections_total counter\\npython_gc_collections_total{generation=\"0\"} 266.0\\npython_gc_collections_total{generation=\"1\"} 24.0\\npython_gc_collections_total{generation=\"2\"} 2.0\\n# HELP python_info Python platform information\\n# TYPE python_info gauge\\npython_info{implementation=\"CPython\",major=\"3\",minor=\"12\",patchlevel=\"2\",version=\"3.12.2\"} 1.0\\n# HELP orchestrator_requests_total HTTP requests\\n# TYPE orchestrator_requests_total counter\\n# HELP orchestrator_ws_connections_total WS connections\\n# TYPE orchestrator_ws_connections_total counter\\n# HELP orchestrator_tool_latency_seconds Tool latency seconds\\n# TYPE orchestrator_tool_latency_seconds histogram\\n# HELP orchestrator_errors_total Errors\\n# TYPE orchestrator_errors_total counter\\n# HELP orchestrator_llm_tokens_total Tokens\\n# TYPE orchestrator_llm_tokens_total counter\\n'\n +  where '# HELP python_gc_objects_collected_total Objects collected during gc\\n# TYPE python_gc_objects_collected_total counter\\npython_gc_objects_collected_total{generation=\"0\"} 6349.0\\npython_gc_objects_collected_total{generation=\"1\"} 4097.0\\npython_gc_objects_collected_total{generation=\"2\"} 2038.0\\n# HELP python_gc_objects_uncollectable_total Uncollectable objects found during GC\\n# TYPE python_gc_objects_uncollectable_total counter\\npython_gc_objects_uncollectable_total{generation=\"0\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"1\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"2\"} 0.0\\n# HELP python_gc_collections_total Number of times this generation was collected\\n# TYPE python_gc_collections_total counter\\npython_gc_collections_total{generation=\"0\"} 266.0\\npython_gc_collections_total{generation=\"1\"} 24.0\\npython_gc_collections_total{generation=\"2\"} 2.0\\n# HELP python_info Python platform information\\n# TYPE python_info gauge\\npython_info{implementation=\"CPython\",major=\"3\",minor=\"12\",patchlevel=\"2\",version=\"3.12.2\"} 1.0\\n# HELP orchestrator_requests_total HTTP requests\\n# TYPE orchestrator_requests_total counter\\n# HELP orchestrator_ws_connections_total WS connections\\n# TYPE orchestrator_ws_connections_total counter\\n# HELP orchestrator_tool_latency_seconds Tool latency seconds\\n# TYPE orchestrator_tool_latency_seconds histogram\\n# HELP orchestrator_errors_total Errors\\n# TYPE orchestrator_errors_total counter\\n# HELP orchestrator_llm_tokens_total Tokens\\n# TYPE orchestrator_llm_tokens_total counter\\n' = <Response [200 OK]>.text"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 57, "message": "in test_metrics_endpoint"}], "stdout": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/metrics\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"89b82433-ba94-4f90-bd0f-42150bd9fd52\", \"sid\": \"8396a9ad-9a1c-475f-a235-aa223fdbe0ae\"}\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/metrics\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"89b82433-ba94-4f90-bd0f-42150bd9fd52\", \"sid\": \"8396a9ad-9a1c-475f-a235-aa223fdbe0ae\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.20871, "msecs": 208.0, "relativeCreated": 844.275951385498, "thread": 6139588608, "threadName": "ThreadPoolExecutor-2_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:57: in test_metrics_endpoint\n    assert \"ai_\" in response.text  # Should contain our custom metrics\nE   assert 'ai_' in '# HELP python_gc_objects_collected_total Objects collected during gc\\n# TYPE python_gc_objects_collected_total counter\\npython_gc_objects_collected_total{generation=\"0\"} 6349.0\\npython_gc_objects_collected_total{generation=\"1\"} 4097.0\\npython_gc_objects_collected_total{generation=\"2\"} 2038.0\\n# HELP python_gc_objects_uncollectable_total Uncollectable objects found during GC\\n# TYPE python_gc_objects_uncollectable_total counter\\npython_gc_objects_uncollectable_total{generation=\"0\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"1\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"2\"} 0.0\\n# HELP python_gc_collections_total Number of times this generation was collected\\n# TYPE python_gc_collections_total counter\\npython_gc_collections_total{generation=\"0\"} 266.0\\npython_gc_collections_total{generation=\"1\"} 24.0\\npython_gc_collections_total{generation=\"2\"} 2.0\\n# HELP python_info Python platform information\\n# TYPE python_info gauge\\npython_info{implementation=\"CPython\",major=\"3\",minor=\"12\",patchlevel=\"2\",version=\"3.12.2\"} 1.0\\n# HELP orchestrator_requests_total HTTP requests\\n# TYPE orchestrator_requests_total counter\\n# HELP orchestrator_ws_connections_total WS connections\\n# TYPE orchestrator_ws_connections_total counter\\n# HELP orchestrator_tool_latency_seconds Tool latency seconds\\n# TYPE orchestrator_tool_latency_seconds histogram\\n# HELP orchestrator_errors_total Errors\\n# TYPE orchestrator_errors_total counter\\n# HELP orchestrator_llm_tokens_total Tokens\\n# TYPE orchestrator_llm_tokens_total counter\\n'\nE    +  where '# HELP python_gc_objects_collected_total Objects collected during gc\\n# TYPE python_gc_objects_collected_total counter\\npython_gc_objects_collected_total{generation=\"0\"} 6349.0\\npython_gc_objects_collected_total{generation=\"1\"} 4097.0\\npython_gc_objects_collected_total{generation=\"2\"} 2038.0\\n# HELP python_gc_objects_uncollectable_total Uncollectable objects found during GC\\n# TYPE python_gc_objects_uncollectable_total counter\\npython_gc_objects_uncollectable_total{generation=\"0\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"1\"} 0.0\\npython_gc_objects_uncollectable_total{generation=\"2\"} 0.0\\n# HELP python_gc_collections_total Number of times this generation was collected\\n# TYPE python_gc_collections_total counter\\npython_gc_collections_total{generation=\"0\"} 266.0\\npython_gc_collections_total{generation=\"1\"} 24.0\\npython_gc_collections_total{generation=\"2\"} 2.0\\n# HELP python_info Python platform information\\n# TYPE python_info gauge\\npython_info{implementation=\"CPython\",major=\"3\",minor=\"12\",patchlevel=\"2\",version=\"3.12.2\"} 1.0\\n# HELP orchestrator_requests_total HTTP requests\\n# TYPE orchestrator_requests_total counter\\n# HELP orchestrator_ws_connections_total WS connections\\n# TYPE orchestrator_ws_connections_total counter\\n# HELP orchestrator_tool_latency_seconds Tool latency seconds\\n# TYPE orchestrator_tool_latency_seconds histogram\\n# HELP orchestrator_errors_total Errors\\n# TYPE orchestrator_errors_total counter\\n# HELP orchestrator_llm_tokens_total Tokens\\n# TYPE orchestrator_llm_tokens_total counter\\n' = <Response [200 OK]>.text"}, "teardown": {"duration": 0.00025158305652439594, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_chat_sync_without_rag", "lineno": 58, "outcome": "failed", "keywords": ["test_chat_sync_without_rag", "__wrapped__", "patchings", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.0027127910871058702, "outcome": "passed"}, "call": {"duration": 0.03292620903812349, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 94, "message": "AssertionError: assert '' == 'Hello! How can I help you?'\n  - Hello! How can I help you?"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 94, "message": "in test_chat_sync_without_rag"}], "stdout": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known\n{\"event\": \"http_request\", \"method\": \"POST\", \"path\": \"/v1/chat\", \"status\": 200, \"duration_ms\": 29, \"cid\": \"63b40f55-8372-44b1-aa3f-220eab8bc3f1\", \"sid\": \"f7598ca7-9d71-4021-abc2-a63ed61483af\"}\n", "log": [{"name": "orchestrator.chat", "msg": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py", "filename": "chat.py", "module": "chat", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known", "stack_info": null, "lineno": 222, "funcName": "_stream_llm_sse", "created": 1757431769.234897, "msecs": 234.0, "relativeCreated": 870.4628944396973, "thread": 6139588608, "threadName": "ThreadPoolExecutor-3_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}, {"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"POST\", \"path\": \"/v1/chat\", \"status\": 200, \"duration_ms\": 29, \"cid\": \"63b40f55-8372-44b1-aa3f-220eab8bc3f1\", \"sid\": \"f7598ca7-9d71-4021-abc2-a63ed61483af\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.2457752, "msecs": 245.0, "relativeCreated": 881.3412189483643, "thread": 6139588608, "threadName": "ThreadPoolExecutor-3_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:94: in test_chat_sync_without_rag\n    assert data[\"text\"] == \"Hello! How can I help you?\"\nE   AssertionError: assert '' == 'Hello! How can I help you?'\nE     - Hello! How can I help you?"}, "teardown": {"duration": 0.00022979103960096836, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_chat_stream_with_rag", "lineno": 95, "outcome": "passed", "keywords": ["test_chat_stream_with_rag", "__wrapped__", "patchings", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.002782291965559125, "outcome": "passed"}, "call": {"duration": 0.01621533278375864, "outcome": "passed", "stdout": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/chat/stream\", \"status\": 200, \"duration_ms\": 4, \"cid\": \"af9c68d4-3ef5-4a3f-a152-668b4c8b8c78\", \"sid\": \"8a2baf24-2bb7-4921-a8e7-1f60a426a0be\"}\nLLM streaming error: [Errno 8] nodename nor servname provided, or not known\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/chat/stream\", \"status\": 200, \"duration_ms\": 4, \"cid\": \"af9c68d4-3ef5-4a3f-a152-668b4c8b8c78\", \"sid\": \"8a2baf24-2bb7-4921-a8e7-1f60a426a0be\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.2592902, "msecs": 259.0, "relativeCreated": 894.8562145233154, "thread": 6139588608, "threadName": "ThreadPoolExecutor-4_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}, {"name": "orchestrator.chat", "msg": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py", "filename": "chat.py", "module": "chat", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known", "stack_info": null, "lineno": 222, "funcName": "_stream_llm_sse", "created": 1757431769.267492, "msecs": 267.0, "relativeCreated": 903.0580520629883, "thread": 6139588608, "threadName": "ThreadPoolExecutor-4_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.responses.StreamingResponse.__call__.<locals>.wrap"}]}, "teardown": {"duration": 0.00023158290423452854, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_chat_without_auth_fails", "lineno": 131, "outcome": "failed", "keywords": ["test_chat_without_auth_fails", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.003285875078290701, "outcome": "passed"}, "call": {"duration": 0.018414709018543363, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 137, "message": "assert 200 == 401\n +  where 200 = <Response [200 OK]>.status_code"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 137, "message": "in test_chat_without_auth_fails"}], "stdout": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known\n{\"event\": \"http_request\", \"method\": \"POST\", \"path\": \"/v1/chat\", \"status\": 200, \"duration_ms\": 14, \"cid\": \"a64eeab1-2cbd-400d-a067-c86c432e6080\", \"sid\": \"016ae426-b4c1-49c1-b649-26cc23207e3d\"}\n", "log": [{"name": "orchestrator.chat", "msg": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py", "filename": "chat.py", "module": "chat", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known", "stack_info": null, "lineno": 222, "funcName": "_stream_llm_sse", "created": 1757431769.282919, "msecs": 282.0, "relativeCreated": 918.4849262237549, "thread": 6139588608, "threadName": "ThreadPoolExecutor-5_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}, {"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"POST\", \"path\": \"/v1/chat\", \"status\": 200, \"duration_ms\": 14, \"cid\": \"a64eeab1-2cbd-400d-a067-c86c432e6080\", \"sid\": \"016ae426-b4c1-49c1-b649-26cc23207e3d\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.2886631, "msecs": 288.0, "relativeCreated": 924.2291450500488, "thread": 6139588608, "threadName": "ThreadPoolExecutor-5_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:137: in test_chat_without_auth_fails\n    assert response.status_code == 401\nE   assert 200 == 401\nE    +  where 200 = <Response [200 OK]>.status_code"}, "teardown": {"duration": 0.00023908307775855064, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_health_endpoints_no_auth_required", "lineno": 138, "outcome": "passed", "keywords": ["test_health_endpoints_no_auth_required", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.002549499971792102, "outcome": "passed"}, "call": {"duration": 0.003544375067576766, "outcome": "passed", "stdout": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/health\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"d3b937c8-104c-479a-872d-ae8946722a0e\", \"sid\": \"be324aae-49fd-45d8-b625-80a8de4dd149\"}\n{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/metrics\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"2f9a181c-ef2a-4399-9d40-1cb2db342734\", \"sid\": \"5323f60f-2785-4810-b64a-8349beff9795\"}\n{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/config\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"b3aa011a-ce63-4265-8f23-fe379bab2ba5\", \"sid\": \"3925312b-e47e-4545-87bd-658a232e65a2\"}\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/health\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"d3b937c8-104c-479a-872d-ae8946722a0e\", \"sid\": \"be324aae-49fd-45d8-b625-80a8de4dd149\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.298032, "msecs": 298.0, "relativeCreated": 933.5980415344238, "thread": 6139588608, "threadName": "ThreadPoolExecutor-6_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}, {"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/metrics\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"2f9a181c-ef2a-4399-9d40-1cb2db342734\", \"sid\": \"5323f60f-2785-4810-b64a-8349beff9795\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.299228, "msecs": 299.0, "relativeCreated": 934.7939491271973, "thread": 6139588608, "threadName": "ThreadPoolExecutor-7_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}, {"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/config\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"b3aa011a-ce63-4265-8f23-fe379bab2ba5\", \"sid\": \"3925312b-e47e-4545-87bd-658a232e65a2\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.300265, "msecs": 300.0, "relativeCreated": 935.8310699462891, "thread": 6139588608, "threadName": "ThreadPoolExecutor-8_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}]}, "teardown": {"duration": 0.00021133292466402054, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_retrieve_proxy_endpoint", "lineno": 150, "outcome": "failed", "keywords": ["test_retrieve_proxy_endpoint", "__wrapped__", "patchings", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.0025939589831978083, "outcome": "passed"}, "call": {"duration": 0.0011992920190095901, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py", "lineno": 19, "message": "fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 161, "message": "in test_retrieve_proxy_endpoint"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 518, "message": "in get"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1066, "message": "in get"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 488, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 837, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 926, "message": "in send"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 954, "message": "in _send_handling_auth"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 991, "message": "in _send_handling_redirects"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1027, "message": "in _send_single_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 381, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 378, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 287, "message": "in call"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 449, "message": "in result"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 401, "message": "in __get_result"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 218, "message": "in _call_func"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", "lineno": 1054, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", "lineno": 113, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 187, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 165, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 185, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/contextlib.py", "lineno": 158, "message": "in __exit__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", "lineno": 83, "message": "in collapse_excgroups"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 187, "message": "in __call__"}, {"path": "../orchestrator/app/main.py", "lineno": 69, "message": "in auth_mw"}, {"path": "../orchestrator/app/middleware.py", "lineno": 19, "message": "in auth_hook"}], "longrepr": "+ Exception Group Traceback (most recent call last):\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 77, in collapse_excgroups\n  |     yield\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 186, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 680, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    |     result: Optional[TResult] = func()\n    |                                 ^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    |     lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    |     raise e\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    |     item.runtest()\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    |     result = testfunction(**testargs)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/unittest/mock.py\", line 1387, in patched\n    |     return func(*newargs, **newkeywargs)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py\", line 161, in test_retrieve_proxy_endpoint\n    |     response = client.get(\n    |                ^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 518, in get\n    |     return super().get(\n    |            ^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1066, in get\n    |     return self.request(\n    |            ^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 488, in request\n    |     return super().request(\n    |            ^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 837, in request\n    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 926, in send\n    |     response = self._send_handling_auth(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 954, in _send_handling_auth\n    |     response = self._send_handling_redirects(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 991, in _send_handling_redirects\n    |     response = self._send_single_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1027, in _send_single_request\n    |     response = transport.handle_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 381, in handle_request\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 378, in handle_request\n    |     portal.call(self.app, scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 287, in call\n    |     return cast(T_Retval, self.start_task_soon(func, *args).result())\n    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    |     return self.__get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    |     raise self._exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 218, in _call_func\n    |     retval = await retval_or_awaitable\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py\", line 1054, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py\", line 113, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 187, in __call__\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 165, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(value)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/main.py\", line 69, in auth_mw\n    |     await auth_hook(request)\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py\", line 19, in auth_hook\n    |     raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\n    | fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\ntest_orchestrator_isolation.py:161: in test_retrieve_proxy_endpoint\n    response = client.get(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:518: in get\n    return super().get(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1066: in get\n    return self.request(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:488: in request\n    return super().request(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:837: in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:926: in send\n    response = self._send_handling_auth(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:954: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:991: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1027: in _send_single_request\n    response = transport.handle_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:381: in handle_request\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:378: in handle_request\n    portal.call(self.app, scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:287: in call\n    return cast(T_Retval, self.start_task_soon(func, *args).result())\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:449: in result\n    return self.__get_result()\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:218: in _call_func\n    retval = await retval_or_awaitable\n/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__\n    await super().__call__(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py:113: in __call__\n    await self.middleware_stack(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__\n    await self.app(scope, receive, _send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:185: in __call__\n    with collapse_excgroups():\n/opt/anaconda3/lib/python3.12/contextlib.py:158: in __exit__\n    self.gen.throw(value)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py:83: in collapse_excgroups\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:187: in __call__\n    response = await self.dispatch_func(request, call_next)\n../orchestrator/app/main.py:69: in auth_mw\n    await auth_hook(request)\n../orchestrator/app/middleware.py:19: in auth_hook\n    raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\nE   fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "teardown": {"duration": 0.0002638748846948147, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_ingest_proxy_endpoint", "lineno": 171, "outcome": "failed", "keywords": ["test_ingest_proxy_endpoint", "__wrapped__", "patchings", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.0026228749193251133, "outcome": "passed"}, "call": {"duration": 0.0011418750509619713, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py", "lineno": 19, "message": "fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 181, "message": "in test_ingest_proxy_endpoint"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 597, "message": "in post"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1157, "message": "in post"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 488, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 837, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 926, "message": "in send"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 954, "message": "in _send_handling_auth"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 991, "message": "in _send_handling_redirects"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1027, "message": "in _send_single_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 381, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 378, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 287, "message": "in call"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 449, "message": "in result"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 401, "message": "in __get_result"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 218, "message": "in _call_func"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", "lineno": 1054, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", "lineno": 113, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 187, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 165, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 185, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/contextlib.py", "lineno": 158, "message": "in __exit__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", "lineno": 83, "message": "in collapse_excgroups"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 187, "message": "in __call__"}, {"path": "../orchestrator/app/main.py", "lineno": 69, "message": "in auth_mw"}, {"path": "../orchestrator/app/middleware.py", "lineno": 19, "message": "in auth_hook"}], "longrepr": "+ Exception Group Traceback (most recent call last):\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 77, in collapse_excgroups\n  |     yield\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 186, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 680, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    |     result: Optional[TResult] = func()\n    |                                 ^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    |     lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    |     raise e\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    |     item.runtest()\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    |     result = testfunction(**testargs)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/unittest/mock.py\", line 1387, in patched\n    |     return func(*newargs, **newkeywargs)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py\", line 181, in test_ingest_proxy_endpoint\n    |     response = client.post(\n    |                ^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 597, in post\n    |     return super().post(\n    |            ^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1157, in post\n    |     return self.request(\n    |            ^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 488, in request\n    |     return super().request(\n    |            ^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 837, in request\n    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 926, in send\n    |     response = self._send_handling_auth(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 954, in _send_handling_auth\n    |     response = self._send_handling_redirects(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 991, in _send_handling_redirects\n    |     response = self._send_single_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1027, in _send_single_request\n    |     response = transport.handle_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 381, in handle_request\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 378, in handle_request\n    |     portal.call(self.app, scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 287, in call\n    |     return cast(T_Retval, self.start_task_soon(func, *args).result())\n    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    |     return self.__get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    |     raise self._exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 218, in _call_func\n    |     retval = await retval_or_awaitable\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py\", line 1054, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py\", line 113, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 187, in __call__\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 165, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(value)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/main.py\", line 69, in auth_mw\n    |     await auth_hook(request)\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py\", line 19, in auth_hook\n    |     raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\n    | fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\ntest_orchestrator_isolation.py:181: in test_ingest_proxy_endpoint\n    response = client.post(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:597: in post\n    return super().post(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1157: in post\n    return self.request(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:488: in request\n    return super().request(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:837: in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:926: in send\n    response = self._send_handling_auth(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:954: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:991: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1027: in _send_single_request\n    response = transport.handle_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:381: in handle_request\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:378: in handle_request\n    portal.call(self.app, scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:287: in call\n    return cast(T_Retval, self.start_task_soon(func, *args).result())\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:449: in result\n    return self.__get_result()\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:218: in _call_func\n    retval = await retval_or_awaitable\n/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__\n    await super().__call__(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py:113: in __call__\n    await self.middleware_stack(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__\n    await self.app(scope, receive, _send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:185: in __call__\n    with collapse_excgroups():\n/opt/anaconda3/lib/python3.12/contextlib.py:158: in __exit__\n    self.gen.throw(value)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py:83: in collapse_excgroups\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:187: in __call__\n    response = await self.dispatch_func(request, call_next)\n../orchestrator/app/main.py:69: in auth_mw\n    await auth_hook(request)\n../orchestrator/app/middleware.py:19: in auth_hook\n    raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\nE   fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "teardown": {"duration": 0.0003107499796897173, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_tts_proxy_endpoint", "lineno": 190, "outcome": "failed", "keywords": ["test_tts_proxy_endpoint", "__wrapped__", "patchings", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.002874207915738225, "outcome": "passed"}, "call": {"duration": 0.0015177498571574688, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py", "lineno": 19, "message": "fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 205, "message": "in test_tts_proxy_endpoint"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 597, "message": "in post"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1157, "message": "in post"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 488, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 837, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 926, "message": "in send"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 954, "message": "in _send_handling_auth"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 991, "message": "in _send_handling_redirects"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1027, "message": "in _send_single_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 381, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 378, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 287, "message": "in call"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 449, "message": "in result"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 401, "message": "in __get_result"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 218, "message": "in _call_func"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", "lineno": 1054, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", "lineno": 113, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 187, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 165, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 185, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/contextlib.py", "lineno": 158, "message": "in __exit__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", "lineno": 83, "message": "in collapse_excgroups"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 187, "message": "in __call__"}, {"path": "../orchestrator/app/main.py", "lineno": 69, "message": "in auth_mw"}, {"path": "../orchestrator/app/middleware.py", "lineno": 19, "message": "in auth_hook"}], "longrepr": "+ Exception Group Traceback (most recent call last):\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 77, in collapse_excgroups\n  |     yield\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 186, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 680, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    |     result: Optional[TResult] = func()\n    |                                 ^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    |     lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    |     raise e\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    |     item.runtest()\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    |     result = testfunction(**testargs)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/unittest/mock.py\", line 1387, in patched\n    |     return func(*newargs, **newkeywargs)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py\", line 205, in test_tts_proxy_endpoint\n    |     response = client.post(\n    |                ^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 597, in post\n    |     return super().post(\n    |            ^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1157, in post\n    |     return self.request(\n    |            ^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 488, in request\n    |     return super().request(\n    |            ^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 837, in request\n    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 926, in send\n    |     response = self._send_handling_auth(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 954, in _send_handling_auth\n    |     response = self._send_handling_redirects(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 991, in _send_handling_redirects\n    |     response = self._send_single_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1027, in _send_single_request\n    |     response = transport.handle_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 381, in handle_request\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 378, in handle_request\n    |     portal.call(self.app, scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 287, in call\n    |     return cast(T_Retval, self.start_task_soon(func, *args).result())\n    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    |     return self.__get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    |     raise self._exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 218, in _call_func\n    |     retval = await retval_or_awaitable\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py\", line 1054, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py\", line 113, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 187, in __call__\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 165, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(value)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/main.py\", line 69, in auth_mw\n    |     await auth_hook(request)\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py\", line 19, in auth_hook\n    |     raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\n    | fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\ntest_orchestrator_isolation.py:205: in test_tts_proxy_endpoint\n    response = client.post(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:597: in post\n    return super().post(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1157: in post\n    return self.request(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:488: in request\n    return super().request(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:837: in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:926: in send\n    response = self._send_handling_auth(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:954: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:991: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1027: in _send_single_request\n    response = transport.handle_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:381: in handle_request\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:378: in handle_request\n    portal.call(self.app, scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:287: in call\n    return cast(T_Retval, self.start_task_soon(func, *args).result())\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:449: in result\n    return self.__get_result()\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:218: in _call_func\n    retval = await retval_or_awaitable\n/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__\n    await super().__call__(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py:113: in __call__\n    await self.middleware_stack(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__\n    await self.app(scope, receive, _send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:185: in __call__\n    with collapse_excgroups():\n/opt/anaconda3/lib/python3.12/contextlib.py:158: in __exit__\n    self.gen.throw(value)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py:83: in collapse_excgroups\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:187: in __call__\n    response = await self.dispatch_func(request, call_next)\n../orchestrator/app/main.py:69: in auth_mw\n    await auth_hook(request)\n../orchestrator/app/middleware.py:19: in auth_hook\n    raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\nE   fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "teardown": {"duration": 0.0002874999772757292, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_invalid_endpoint_returns_404", "lineno": 214, "outcome": "failed", "keywords": ["test_invalid_endpoint_returns_404", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.005507375113666058, "outcome": "passed"}, "call": {"duration": 0.012591708917170763, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py", "lineno": 19, "message": "fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 217, "message": "in test_invalid_endpoint_returns_404"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 518, "message": "in get"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1066, "message": "in get"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 488, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 837, "message": "in request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 926, "message": "in send"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 954, "message": "in _send_handling_auth"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 991, "message": "in _send_handling_redirects"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py", "lineno": 1027, "message": "in _send_single_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 381, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py", "lineno": 378, "message": "in handle_request"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 287, "message": "in call"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 449, "message": "in result"}, {"path": "/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py", "lineno": 401, "message": "in __get_result"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py", "lineno": 218, "message": "in _call_func"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", "lineno": 1054, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", "lineno": 113, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 187, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 165, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 185, "message": "in __call__"}, {"path": "/opt/anaconda3/lib/python3.12/contextlib.py", "lineno": 158, "message": "in __exit__"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", "lineno": 83, "message": "in collapse_excgroups"}, {"path": "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", "lineno": 187, "message": "in __call__"}, {"path": "../orchestrator/app/main.py", "lineno": 69, "message": "in auth_mw"}, {"path": "../orchestrator/app/middleware.py", "lineno": 19, "message": "in auth_hook"}], "longrepr": "+ Exception Group Traceback (most recent call last):\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 77, in collapse_excgroups\n  |     yield\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 186, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 680, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 341, in from_call\n    |     result: Optional[TResult] = func()\n    |                                 ^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 262, in <lambda>\n    |     lambda: ihook(item=item, **kwds), when=when, reraise=reraise\n    |             ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 177, in pytest_runtest_call\n    |     raise e\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/runner.py\", line 169, in pytest_runtest_call\n    |     item.runtest()\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 1792, in runtest\n    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_hooks.py\", line 512, in __call__\n    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_manager.py\", line 120, in _hookexec\n    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 167, in _multicall\n    |     raise exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 139, in _multicall\n    |     teardown.throw(exception)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 53, in run_old_style_hookwrapper\n    |     return result.get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_result.py\", line 103, in get_result\n    |     raise exc.with_traceback(tb)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 38, in run_old_style_hookwrapper\n    |     res = yield\n    |           ^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/pluggy/_callers.py\", line 121, in _multicall\n    |     res = hook_impl.function(*args)\n    |           ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/_pytest/python.py\", line 194, in pytest_pyfunc_call\n    |     result = testfunction(**testargs)\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py\", line 217, in test_invalid_endpoint_returns_404\n    |     response = client.get(\"/v1/nonexistent\")\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 518, in get\n    |     return super().get(\n    |            ^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1066, in get\n    |     return self.request(\n    |            ^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 488, in request\n    |     return super().request(\n    |            ^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 837, in request\n    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 926, in send\n    |     response = self._send_handling_auth(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 954, in _send_handling_auth\n    |     response = self._send_handling_redirects(\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 991, in _send_handling_redirects\n    |     response = self._send_single_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1027, in _send_single_request\n    |     response = transport.handle_request(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 381, in handle_request\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py\", line 378, in handle_request\n    |     portal.call(self.app, scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 287, in call\n    |     return cast(T_Retval, self.start_task_soon(func, *args).result())\n    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 449, in result\n    |     return self.__get_result()\n    |            ^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py\", line 401, in __get_result\n    |     raise self._exception\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py\", line 218, in _call_func\n    |     retval = await retval_or_awaitable\n    |              ^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py\", line 1054, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py\", line 113, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 187, in __call__\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py\", line 165, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 185, in __call__\n    |     with collapse_excgroups():\n    |   File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(value)\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py\", line 83, in collapse_excgroups\n    |     raise exc\n    |   File \"/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py\", line 187, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/main.py\", line 69, in auth_mw\n    |     await auth_hook(request)\n    |   File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/middleware.py\", line 19, in auth_hook\n    |     raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\n    | fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}\n    +------------------------------------\n\nDuring handling of the above exception, another exception occurred:\ntest_orchestrator_isolation.py:217: in test_invalid_endpoint_returns_404\n    response = client.get(\"/v1/nonexistent\")\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:518: in get\n    return super().get(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1066: in get\n    return self.request(\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:488: in request\n    return super().request(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:837: in request\n    return self.send(request, auth=auth, follow_redirects=follow_redirects)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:926: in send\n    response = self._send_handling_auth(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:954: in _send_handling_auth\n    response = self._send_handling_redirects(\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:991: in _send_handling_redirects\n    response = self._send_single_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py:1027: in _send_single_request\n    response = transport.handle_request(request)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:381: in handle_request\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/testclient.py:378: in handle_request\n    portal.call(self.app, scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:287: in call\n    return cast(T_Retval, self.start_task_soon(func, *args).result())\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:449: in result\n    return self.__get_result()\n/opt/anaconda3/lib/python3.12/concurrent/futures/_base.py:401: in __get_result\n    raise self._exception\n/opt/anaconda3/lib/python3.12/site-packages/anyio/from_thread.py:218: in _call_func\n    retval = await retval_or_awaitable\n/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__\n    await super().__call__(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py:113: in __call__\n    await self.middleware_stack(scope, receive, send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:187: in __call__\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py:165: in __call__\n    await self.app(scope, receive, _send)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:185: in __call__\n    with collapse_excgroups():\n/opt/anaconda3/lib/python3.12/contextlib.py:158: in __exit__\n    self.gen.throw(value)\n/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py:83: in collapse_excgroups\n    raise exc\n/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py:187: in __call__\n    response = await self.dispatch_func(request, call_next)\n../orchestrator/app/main.py:69: in auth_mw\n    await auth_hook(request)\n../orchestrator/app/middleware.py:19: in auth_hook\n    raise HTTPException(status_code=401, detail={\"code\":\"unauthorized\",\"message\":\"Invalid token\"})\nE   fastapi.exceptions.HTTPException: 401: {'code': 'unauthorized', 'message': 'Invalid token'}"}, "teardown": {"duration": 0.00029358314350247383, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_cors_headers_present", "lineno": 219, "outcome": "failed", "keywords": ["test_cors_headers_present", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.0029845000244677067, "outcome": "passed"}, "call": {"duration": 0.0019249580800533295, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 223, "message": "assert 405 == 200\n +  where 405 = <Response [405 Method Not Allowed]>.status_code"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 223, "message": "in test_cors_headers_present"}], "stdout": "{\"event\": \"http_request\", \"method\": \"OPTIONS\", \"path\": \"/v1/health\", \"status\": 405, \"duration_ms\": 0, \"cid\": \"e7458bb8-bad4-42c5-b774-2a6d4423458f\", \"sid\": \"66396965-248d-42cc-aa68-54bbd553b181\"}\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"OPTIONS\", \"path\": \"/v1/health\", \"status\": 405, \"duration_ms\": 0, \"cid\": \"e7458bb8-bad4-42c5-b774-2a6d4423458f\", \"sid\": \"66396965-248d-42cc-aa68-54bbd553b181\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.6633432, "msecs": 663.0, "relativeCreated": 1298.9091873168945, "thread": 6139588608, "threadName": "ThreadPoolExecutor-13_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:223: in test_cors_headers_present\n    assert response.status_code == 200\nE   assert 405 == 200\nE    +  where 405 = <Response [405 Method Not Allowed]>.status_code"}, "teardown": {"duration": 0.0002454998902976513, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_error_handling_upstream_failure", "lineno": 225, "outcome": "failed", "keywords": ["test_error_handling_upstream_failure", "__wrapped__", "patchings", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.0028645829297602177, "outcome": "passed"}, "call": {"duration": 0.01803049980662763, "outcome": "failed", "crash": {"path": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/tests/test_orchestrator_isolation.py", "lineno": 245, "message": "assert 200 in [502, 500]\n +  where 200 = <Response [200 OK]>.status_code"}, "traceback": [{"path": "test_orchestrator_isolation.py", "lineno": 245, "message": "in test_error_handling_upstream_failure"}], "stdout": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known\n{\"event\": \"http_request\", \"method\": \"POST\", \"path\": \"/v1/chat\", \"status\": 200, \"duration_ms\": 15, \"cid\": \"e71c17c2-6291-46f6-90c4-718627cbd814\", \"sid\": \"eb90a093-d217-4320-9500-bf10bcfb77aa\"}\n", "log": [{"name": "orchestrator.chat", "msg": "LLM streaming error: [Errno 8] nodename nor servname provided, or not known", "args": null, "levelname": "ERROR", "levelno": 40, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py", "filename": "chat.py", "module": "chat", "exc_info": null, "exc_text": "Traceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 187, in connect_tcp\n    addr_obj = ip_address(remote_host)\n               ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/ipaddress.py\", line 54, in ip_address\n    raise ValueError(f'{address!r} does not appear to be an IPv4 or IPv6 address')\nValueError: 'llm' does not appear to be an IPv4 or IPv6 address\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 10, in map_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 114, in connect_tcp\n    stream: anyio.abc.ByteStream = await anyio.connect_tcp(\n                                   ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 190, in connect_tcp\n    gai_res = await getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_core/_sockets.py\", line 568, in getaddrinfo\n    gai_res = await get_async_backend().getaddrinfo(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/anyio/_backends/_asyncio.py\", line 2403, in getaddrinfo\n    return await get_running_loop().getaddrinfo(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/asyncio/base_events.py\", line 899, in getaddrinfo\n    return await self.run_in_executor(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/concurrent/futures/thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 72, in map_httpcore_exceptions\n    yield\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 377, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 268, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection_pool.py\", line 251, in handle_async_request\n    response = await connection.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 99, in handle_async_request\n    raise exc\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 76, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_async/connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/auto.py\", line 30, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_backends/anyio.py\", line 112, in connect_tcp\n    with map_exceptions(exc_map):\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpcore/_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: [Errno 8] nodename nor servname provided, or not known\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/routes/chat.py\", line 140, in _stream_llm_sse\n    async with client.stream(\"POST\", llm_url, json=body, headers=headers) as resp:\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1628, in stream\n    response = await self.send(\n               ^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1674, in send\n    response = await self._send_handling_auth(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1702, in _send_handling_auth\n    response = await self._send_handling_redirects(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1739, in _send_handling_redirects\n    response = await self._send_single_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_client.py\", line 1776, in _send_single_request\n    response = await transport.handle_async_request(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 376, in handle_async_request\n    with map_httpcore_exceptions():\n  File \"/opt/anaconda3/lib/python3.12/contextlib.py\", line 158, in __exit__\n    self.gen.throw(value)\n  File \"/opt/anaconda3/lib/python3.12/site-packages/httpx/_transports/default.py\", line 89, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: [Errno 8] nodename nor servname provided, or not known", "stack_info": null, "lineno": 222, "funcName": "_stream_llm_sse", "created": 1757431769.679125, "msecs": 679.0, "relativeCreated": 1314.6910667419434, "thread": 6139588608, "threadName": "ThreadPoolExecutor-14_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}, {"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"POST\", \"path\": \"/v1/chat\", \"status\": 200, \"duration_ms\": 15, \"cid\": \"e71c17c2-6291-46f6-90c4-718627cbd814\", \"sid\": \"eb90a093-d217-4320-9500-bf10bcfb77aa\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.685909, "msecs": 685.0, "relativeCreated": 1321.4750289916992, "thread": 6139588608, "threadName": "ThreadPoolExecutor-14_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}], "longrepr": "test_orchestrator_isolation.py:245: in test_error_handling_upstream_failure\n    assert response.status_code in [502, 500]\nE   assert 200 in [502, 500]\nE    +  where 200 = <Response [200 OK]>.status_code"}, "teardown": {"duration": 0.00028616609051823616, "outcome": "passed"}}, {"nodeid": "test_orchestrator_isolation.py::TestOrchestratorIsolation::test_request_correlation_id", "lineno": 246, "outcome": "passed", "keywords": ["test_request_correlation_id", "TestOrchestratorIsolation", "test_orchestrator_isolation.py", "__init__.py", "tests"], "setup": {"duration": 0.0028328748885542154, "outcome": "passed"}, "call": {"duration": 0.0017584997694939375, "outcome": "passed", "stdout": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/health\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"caec2464-f049-4a7e-a52e-14f3b0ef9d6c\", \"sid\": \"87a932c3-ae9f-4fcf-b2bf-4d79d249860c\"}\n", "log": [{"name": "orchestrator", "msg": "{\"event\": \"http_request\", \"method\": \"GET\", \"path\": \"/v1/health\", \"status\": 200, \"duration_ms\": 0, \"cid\": \"caec2464-f049-4a7e-a52e-14f3b0ef9d6c\", \"sid\": \"87a932c3-ae9f-4fcf-b2bf-4d79d249860c\"}", "args": null, "levelname": "INFO", "levelno": 20, "pathname": "/Users/mansi/Documents/Agentic-AI-Digital-U3-----1234 copy/backend/orchestrator/app/logging.py", "filename": "logging.py", "module": "logging", "exc_info": null, "exc_text": null, "stack_info": null, "lineno": 15, "funcName": "json_log", "created": 1757431769.6945379, "msecs": 694.0, "relativeCreated": 1330.103874206543, "thread": 6139588608, "threadName": "ThreadPoolExecutor-15_0", "processName": "MainProcess", "process": 97264, "taskName": "starlette.middleware.base.BaseHTTPMiddleware.__call__.<locals>.call_next.<locals>.coro"}]}, "teardown": {"duration": 0.00025570811703801155, "outcome": "passed"}}], "warnings": [{"message": "Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.8/migration/", "category": "PydanticDeprecatedSince20", "when": "collect", "filename": "/opt/anaconda3/lib/python3.12/site-packages/pydantic/_internal/_config.py", "lineno": 291}]}